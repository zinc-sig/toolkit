---
name: GCC Test with Empty Prepare
description: Verify compilation works with empty prepare step

mock_resources:
  submission:
    files:
      hello.c: |
        #include <stdio.h>
        int main() {
            printf("Hello, World!\n");
            printf("Testing compilation task with empty prepare step!\n");
            return 0;
        }
  
  assignment_assets:
    files:
      placeholder.txt: "placeholder"

# Empty prepare step - should not break anything
preparation:
  image:
    repository: busybox
    tag: latest
  outputs: []  # No outputs
  script: |
    echo "This prepare step does nothing"
    echo "Testing that empty prepare doesn't break pipeline"
    echo "Pipeline should proceed normally to the compilation step"

task_parameters:
  source_file: "submission/hello.c"
  output_binary: "hello"
  compiler_flags: "-Wall -Wextra -O2"
  language: "c"
  version: "latest"
  score: "10"

verification:
  image:
    repository: busybox
    tag: latest
  script: |
    echo "Checking compilation output..."
    if [ -f compilation-output/hello ]; then
      echo "✅ Binary created successfully"
      chmod +x compilation-output/hello
      echo "Running binary:"
      ./compilation-output/hello
      echo "✅ Empty prepare step didn't interfere with compilation!"
    else
      echo "❌ Binary not found"
      exit 1
    fi